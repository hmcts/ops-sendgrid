parameters:
  env: ''
steps:
- task: PowerShell@2
  displayName: 'Deploy NonProd Configuration'
  inputs:
    targetType: inline
    script: |
      echo 'nonprod'
      echo 'new'
      echo $nonprod-config.GetType();
      Foreach ($i in $(nonprod-config))
      {
        
        echo 'loop'
        New-AzResourceGroup -Name $i-nonprod -Location UKSouth
        New-AzResourceGroupDeployment -ResourceGroupName $i-nonprod `-TemplateFile arm/template.json 
      }
  condition: eq('${{ parameters.env }}', 'nonprod')
- task: PowerShell@2
  displayName: 'Deploy Prod Configuration'
  inputs:
    targetType: inline
    arguments: # Optional
    script: |
      echo 'prod'
      echo $(prod-config)
      New-AzResourceGroup -Name $resourceGroupName -Location $location
      New-AzResourceGroupDeployment -ResourceGroupName $resourceGroupName `-TemplateFile arm/template.json  
  condition: eq('${{ parameters.env }}', 'prod')
